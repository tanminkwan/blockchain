sequenceDiagram
    participant 송신자
    participant Ledger
    participant 수신자

    Note over 송신자,수신자: 과거의 어느 시점

    수신자->>송신자: 수신자의 공개키 전송 (안전한 방식으로)

    송신자->>수신자: 송신자의 공개키 전송 (안전한 방식으로)

    Note over 송신자,수신자: 거래 시작

    송신자->>송신자: 비밀번호와 솔트 입력하여 암호화 키 생성

    송신자->>Ledger: 원장 초기화 및 로드

    송신자->>송신자: RSA 키 페어 로드 또는 생성

    송신자->>송신자: 마지막 트랜잭션 해시를 Chaining 해서 새로운 트랜잭션 생성

    송신자->>송신자: 트랜잭션 서명

    송신자->>Ledger: 트랜잭션을 원장에 추가

    송신자->>송신자: 대칭키 생성 (일회용)

    송신자->>송신자: 트랜잭션 데이터 대칭키로 암호화

    송신자->>송신자: 대칭키를 수신자의 공개키로 암호화

    송신자->>수신자: 암호화된 대칭키와 트랜잭션 데이터 전송

    수신자->>수신자: 암호화된 대칭키를 자신의 비밀키로 복호화

    수신자->>수신자: 대칭키로 트랜잭션 데이터 복호화

    수신자->>수신자: 송신자의 공개키로 트랜잭션 서명 검증

    alt 검증 성공
        수신자->>수신자: 트랜잭션 처리 완료
    else 검증 실패
        수신자->>수신자: 트랜잭션 처리 중단
    end

    Note over 송신자,수신자: 거래 종료